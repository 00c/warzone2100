-- Generated by wz2lua (implementation file)
version(0) --- version of the script API this script is written for

-- Predamage structures
count = 0
temp = 0

-- briefing when landed


function start()
	setPowerLevel(startPow, player)
	
	-- set rubble under buildings - tile 67
	
	setRubbleTile(67)
	
	-- pre damage structures
	count = 0
	while count < numStructs do
		forceDamageObject(structs[count], random(20) + 40)
		count = count + 1
	end
	-- pre damage droids
	count = 0
	while count < numDroids do
		forceDamageObject(droids[count], random(20) + 40)
		count = count + 1
	end
	
	-- take over the selectedPlayer's units to avoid id number clashes on later levels
	-- this needs to be done AFTER the units have been damaged. The coords were taken from
	-- the world editor
	takeOverDroidsInArea(0, 0, 10900, 11800, 12900, 13650)
end
callbackEvent(start, CALL_GAMEINIT)

function removeBrief()
	removeMessage(brief, MISS_MSG, 0)
	deactivateEvent(removeBrief)
end

function giveBrief()
	playSound(incomingSnd, player)
	pause(20/10.0)
	callbackEvent(removeBrief, CALL_VIDEO_QUIT)
	addMessage(brief, MISS_MSG, 0, true)
	deactivateEvent(giveBrief)
end
delayedEvent(giveBrief, 10.0)


---------- stubs ----------

if takeOverDroidsInArea == nil then takeOverDroidsInArea = function() print("stub: takeOverDroidsInArea"); return 0 end end
if pause == nil then pause = function() print("stub: pause"); return 0 end end
if setEventTrigger == nil then setEventTrigger = function() print("stub: setEventTrigger"); return 0 end end
if addMessage == nil then addMessage = function() print("stub: addMessage"); return 0 end end
if removeMessage == nil then removeMessage = function() print("stub: removeMessage"); return 0 end end
if random == nil then random = function() print("stub: random"); return 0 end end
if forceDamageObject == nil then forceDamageObject = function() print("stub: forceDamageObject"); return 0 end end
if setRubbleTile == nil then setRubbleTile = function() print("stub: setRubbleTile"); return 0 end end
if setPowerLevel == nil then setPowerLevel = function() print("stub: setPowerLevel"); return 0 end end
if playSound == nil then playSound = function() print("stub: playSound"); return 0 end end
